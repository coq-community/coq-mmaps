<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./../..">Project Website</a>
      <a href="./indexpage.html">Index</a>
      <a href="./toc.html">Table of Contents</a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<div class="code">
</div>

<div class="doc">
<a id="lab134"></a><h1 class="section">Finite Modular Maps: RBT Proofs</h1>

<div class="paragraph"> </div>

 Author: Pierre Letouzey (Université de Paris - INRIA),
    adapted from earlier works in Coq Standard Library, see README.md.
    License: LGPL-2.1-only, see file LICENSE. 
<div class="paragraph"> </div>

 This is a complement to <span class="inlinecode"><span class="id" title="library">MMaps.RBT</span></span>, proving the Red/Black balancing
    invariants for the code in <span class="inlinecode"><span class="id" title="library">MMaps.RBT</span></span>, and hence the logarithmic
    depth bound. These extra proofs are not even loaded during a regular
    usage of <span class="inlinecode"><span class="id" title="library">MMaps.RBT</span></span>, which already provides proofs of observational
    correctness (the binary search tree invariants).

<div class="paragraph"> </div>

    This is an adapation of Coq <span class="inlinecode"><span class="id" title="var">MSetRBT.BalanceProps</span></span> to maps. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.BinPos.html#"><span class="id" title="library">BinPos</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.Pnat.html#"><span class="id" title="library">Pnat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Setoids.Setoid.html#"><span class="id" title="library">Setoid</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.SetoidList.html#"><span class="id" title="library">SetoidList</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.Arith.html#"><span class="id" title="library">Arith</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.Orders.html#"><span class="id" title="library">Orders</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.OrdersFacts.html#"><span class="id" title="library">OrdersFacts</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.OrdersLists.html#"><span class="id" title="library">OrdersLists</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MMaps</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MMaps.Interface.html#"><span class="id" title="library">Interface</span></a> <a class="idref" href="MMaps.GenTree.html#"><span class="id" title="library">GenTree</span></a> <a class="idref" href="MMaps.RBT.html#"><span class="id" title="library">RBT</span></a>.<br/>

<br/>
<span class="id" title="keyword">Local Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Strict</span> <span class="id" title="keyword">Implicit</span>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;For&nbsp;nicer&nbsp;extraction,&nbsp;we&nbsp;create&nbsp;inductive&nbsp;principles<br/>
&nbsp;&nbsp;&nbsp;only&nbsp;when&nbsp;needed&nbsp;*)</span><br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Unset</span> <span class="id" title="var">Elimination</span> <span class="id" title="var">Schemes</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="BalanceProps" class="idref" href="#BalanceProps"><span class="id" title="module">BalanceProps</span></a>(<span class="id" title="var">K</span>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.Orders.html#OrderedType"><span class="id" title="module">OrderedType</span></a>).<br/>
<span class="id" title="keyword">Include</span> <a class="idref" href="MMaps.RBT.html#MakeRaw"><span class="id" title="module">MMaps.RBT.MakeRaw</span></a> <a class="idref" href="MMaps.RBTproofs.html#K"><span class="id" title="module">K</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MMaps.GenTree.html#PairNotations"><span class="id" title="module">GenTree.PairNotations</span></a>. <span class="comment">(*&nbsp;1 and 2&nbsp;for&nbsp;fst&nbsp;and&nbsp;snd&nbsp;*)</span><br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">lazy_bool_scope</span>.<br/>
<span class="id" title="keyword">Local Notation</span> <a id="BalanceProps.color" class="idref" href="#BalanceProps.color"><span class="id" title="abbreviation">color</span></a> := <a class="idref" href="MMaps.RBT.html#Color.t"><span class="id" title="definition">Color.t</span></a>.<br/>
<span class="id" title="keyword">Local Arguments</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Leaf"><span class="id" title="constructor">Leaf</span></a> {<span class="id" title="var">elt</span>}.<br/>
<span class="id" title="keyword">Local Notation</span> <a id="BalanceProps.Rd" class="idref" href="#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> := (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <a class="idref" href="MMaps.RBT.html#Red"><span class="id" title="constructor">Red</span></a>).<br/>
<span class="id" title="keyword">Local Notation</span> <a id="BalanceProps.Bk" class="idref" href="#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> := (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <a class="idref" href="MMaps.RBT.html#Black"><span class="id" title="constructor">Black</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab135"></a><h2 class="section">Red-black invariants</h2>

<div class="paragraph"> </div>

 In a red-black tree :
<ul class="doclist">
<li> a red node has no red children

</li>
<li> the black depth at each node is the same along all paths.

</li>
</ul>
    The black depth is here an argument of the predicate. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="BalanceProps.rbt" class="idref" href="#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a id="elt:1" class="idref" href="#elt:1"><span class="id" title="binder">elt</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.tree"><span class="id" title="inductive">tree</span></a> <span class="id" title="var">elt</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;| <a id="BalanceProps.RB_Leaf" class="idref" href="#BalanceProps.RB_Leaf"><span class="id" title="constructor">RB_Leaf</span></a> : <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> 0 <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;| <a id="BalanceProps.RB_Rd" class="idref" href="#BalanceProps.RB_Rd"><span class="id" title="constructor">RB_Rd</span></a> <a id="n:4" class="idref" href="#n:4"><span class="id" title="binder">n</span></a> <a id="l:5" class="idref" href="#l:5"><span class="id" title="binder">l</span></a> <a id="k:6" class="idref" href="#k:6"><span class="id" title="binder">k</span></a> <a id="e:7" class="idref" href="#e:7"><span class="id" title="binder">e</span></a> <a id="r:8" class="idref" href="#r:8"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:5"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:8"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:4"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:5"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:4"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:8"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:4"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:5"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#k:6"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:7"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:8"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;| <a id="BalanceProps.RB_Bk" class="idref" href="#BalanceProps.RB_Bk"><span class="id" title="constructor">RB_Bk</span></a> <a id="n:9" class="idref" href="#n:9"><span class="id" title="binder">n</span></a> <a id="l:10" class="idref" href="#l:10"><span class="id" title="binder">l</span></a> <a id="k:11" class="idref" href="#k:11"><span class="id" title="binder">k</span></a> <a id="e:12" class="idref" href="#e:12"><span class="id" title="binder">e</span></a> <a id="r:13" class="idref" href="#r:13"><span class="id" title="binder">r</span></a> : <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:9"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:10"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:9"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:13"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#rbt:2"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:9"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:10"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#k:11"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:12"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:13"><span class="id" title="variable">r</span></a>).<br/>

<br/>
</div>

<div class="doc">
A red-red tree is almost a red-black tree, except that it has
    a <i>red</i> root node which <i>may</i> have red children. Note that a
    red-red tree is hence non-empty, and all its strict subtrees
    are red-black. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="BalanceProps.rrt" class="idref" href="#BalanceProps.rrt"><span class="id" title="inductive">rrt</span></a> <a id="elt:14" class="idref" href="#elt:14"><span class="id" title="binder">elt</span></a> (<a id="n:15" class="idref" href="#n:15"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.tree"><span class="id" title="inductive">tree</span></a> <span class="id" title="var">elt</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;| <a id="BalanceProps.RR_Rd" class="idref" href="#BalanceProps.RR_Rd"><span class="id" title="constructor">RR_Rd</span></a> <a id="l:18" class="idref" href="#l:18"><span class="id" title="binder">l</span></a> <a id="k:19" class="idref" href="#k:19"><span class="id" title="binder">k</span></a> <a id="e:20" class="idref" href="#e:20"><span class="id" title="binder">e</span></a> <a id="r:21" class="idref" href="#r:21"><span class="id" title="binder">r</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:15"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:18"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:15"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:21"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#rrt:16"><span class="id" title="inductive">rrt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:15"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:18"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#k:19"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:20"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:21"><span class="id" title="variable">r</span></a>).<br/>

<br/>
</div>

<div class="doc">
An almost-red-black tree is almost a red-black tree, except that
    it's permitted to have two red nodes in a row at the very root (only).
    We implement this notion by saying that a quasi-red-black tree
    is either a red-black tree or a red-red tree. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="BalanceProps.arbt" class="idref" href="#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a id="elt:22" class="idref" href="#elt:22"><span class="id" title="binder">elt</span></a> (<a id="n:23" class="idref" href="#n:23"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)(<a id="t:24" class="idref" href="#t:24"><span class="id" title="binder">t</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="MMaps.RBTproofs.html#elt:22"><span class="id" title="variable">elt</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;| <a id="BalanceProps.ARB_RB" class="idref" href="#BalanceProps.ARB_RB"><span class="id" title="constructor">ARB_RB</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:23"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:24"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#arbt:25"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:23"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:24"><span class="id" title="variable">t</span></a><br/>
&nbsp;| <a id="BalanceProps.ARB_RR" class="idref" href="#BalanceProps.ARB_RR"><span class="id" title="constructor">ARB_RR</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rrt"><span class="id" title="inductive">rrt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:23"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:24"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#arbt:25"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:23"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:24"><span class="id" title="variable">t</span></a>.<br/>

<br/>
</div>

<div class="doc">
The main exported invariant : being a red-black tree for some
    black depth. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <a id="BalanceProps.Rbt" class="idref" href="#BalanceProps.Rbt"><span class="id" title="inductive, record"><span id="BalanceProps.Rbt" class="id">Rbt</span></span></a> <a id="elt:27" class="idref" href="#elt:27"><span class="id" title="binder">elt</span></a> (<a id="t:28" class="idref" href="#t:28"><span class="id" title="binder">t</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="MMaps.RBTproofs.html#elt:27"><span class="id" title="variable">elt</span></a>) :=  <a id="BalanceProps.RBT" class="idref" href="#BalanceProps.RBT"><span class="id" title="constructor, projection"><span id="BalanceProps.RBT" class="id">RBT</span></span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="d:30" class="idref" href="#d:30"><span class="id" title="binder">d</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#d:30"><span class="id" title="variable">d</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:28"><span class="id" title="variable">t</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab136"></a><h2 class="section">Basic tactics and results about red-black trees</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Scheme</span> <a id="BalanceProps.rbt_ind" class="idref" href="#BalanceProps.rbt_ind"><span class="id" title="definition">rbt_ind</span></a> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Local Hint Constructors</span> <a class="idref" href="MMaps.RBTproofs.html#rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#rrt"><span class="id" title="inductive">rrt</span></a> <a class="idref" href="MMaps.RBTproofs.html#arbt"><span class="id" title="inductive">arbt</span></a> : <span class="id" title="var">map</span>.<br/>
<span class="id" title="keyword">Local Hint Extern</span> 0 (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <span class="id" title="var">_</span>) ⇒ (<span class="id" title="tactic">exact</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#I"><span class="id" title="constructor">I</span></a>) : <span class="id" title="var">map</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">invrb</span> := <span class="id" title="tactic">intros</span>; <span class="id" title="var">inv</span> <span class="id" title="var">rrt</span>; <span class="id" title="var">inv</span> <span class="id" title="var">rbt</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">descolor</span> := <span class="id" title="var">destruct_all</span> <span class="id" title="var">Color.t</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destree</span> <span class="id" title="var">t</span> := <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [|[|] ? ? ? ?].<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">desarb</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nonzero</span> <span class="id" title="var">n</span> := <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span>]; [<span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>; <span class="id" title="var">invrb</span>|].<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="BalanceProps.notredred" class="idref" href="#BalanceProps.notredred"><span class="id" title="abbreviation">notredred</span></a> := (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rrcase"><span class="id" title="definition">rrcase</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="BalanceProps.Elt" class="idref" href="#BalanceProps.Elt"><span class="id" title="section">Elt</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a id="BalanceProps.Elt.elt" class="idref" href="#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">t</span> <span class="id" title="var">s</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">e</span> <span class="id" title="var">v</span> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rr_nrr_rb" class="idref" href="#BalanceProps.rr_nrr_rb"><span class="id" title="lemma">rr_nrr_rb</span></a> <a id="n:34" class="idref" href="#n:34"><span class="id" title="binder">n</span></a> <a id="t:35" class="idref" href="#t:35"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rrt"><span class="id" title="inductive">rrt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:34"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:35"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notredred"><span class="id" title="abbreviation">notredred</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:35"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:34"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:35"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> 1 <span class="id" title="keyword">as</span> [<span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hr</span>].<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rrcase"><span class="id" title="definition">rrcase</span></a>; <span class="id" title="var">destmatch</span>; <span class="id" title="var">now</span> <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Hint Resolve</span> <span class="id" title="var">rr_nrr_rb</span> : <span class="id" title="var">map</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.arb_nrr_rb" class="idref" href="#BalanceProps.arb_nrr_rb"><span class="id" title="lemma">arb_nrr_rb</span></a> <a id="n:36" class="idref" href="#n:36"><span class="id" title="binder">n</span></a> <a id="t:37" class="idref" href="#t:37"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:36"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:37"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notredred"><span class="id" title="abbreviation">notredred</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:37"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:36"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:37"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> 1; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.arb_nr_rb" class="idref" href="#BalanceProps.arb_nr_rb"><span class="id" title="lemma">arb_nr_rb</span></a> <a id="n:38" class="idref" href="#n:38"><span class="id" title="binder">n</span></a> <a id="t:39" class="idref" href="#t:39"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:38"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:39"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:39"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:38"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:39"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> 1; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="var">descolor</span>; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Hint Resolve</span> <span class="id" title="var">arb_nrr_rb</span> <span class="id" title="var">arb_nr_rb</span> : <span class="id" title="var">map</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab137"></a><h2 class="section">A red-black tree has a logarithmic depth</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="BalanceProps.redcarac" class="idref" href="#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <a id="s:40" class="idref" href="#s:40"><span class="id" title="binder">s</span></a> :=<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rcase"><span class="id" title="definition">rcase</span></a> (<span class="id" title="var">elt</span>:=<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ 1) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ 0) <a class="idref" href="MMaps.RBTproofs.html#s:40"><span class="id" title="variable">s</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rb_maxdepth" class="idref" href="#BalanceProps.rb_maxdepth"><span class="id" title="lemma">rb_maxdepth</span></a> <a id="s:41" class="idref" href="#s:41"><span class="id" title="binder">s</span></a> <a id="n:42" class="idref" href="#n:42"><span class="id" title="binder">n</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:42"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:41"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.maxdepth"><span class="id" title="definition">maxdepth</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:41"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a><a class="idref" href="MMaps.RBTproofs.html#n:42"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:41"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;- <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;- <span class="id" title="tactic">replace</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <span class="id" title="var">l</span>) <span class="id" title="keyword">with</span> 0 <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="var">destree</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <span class="id" title="var">r</span>) <span class="id" title="keyword">with</span> 0 <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="var">destree</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.maxdepth"><span class="id" title="definition">maxdepth</span></a>. <span class="id" title="tactic">simpl</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_le_mono"><span class="id" title="lemma">Nat.succ_le_mono</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.max_lub"><span class="id" title="lemma">Nat.max_lub</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_le_mono"><span class="id" title="lemma">Nat.succ_le_mono</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.max_lub"><span class="id" title="lemma">Nat.max_lub</span></a>; <span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.le_trans"><span class="id" title="lemma">Nat.le_trans</span></a>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;[<span class="id" title="var">destree</span> <span class="id" title="var">l</span> | <span class="id" title="var">destree</span> <span class="id" title="var">r</span>]; <span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rb_mindepth" class="idref" href="#BalanceProps.rb_mindepth"><span class="id" title="lemma">rb_mindepth</span></a> <a id="s:43" class="idref" href="#s:43"><span class="id" title="binder">s</span></a> <a id="n:44" class="idref" href="#n:44"><span class="id" title="binder">n</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:44"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:43"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:44"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:43"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.mindepth"><span class="id" title="definition">mindepth</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:43"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;- <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> → <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_le_mono"><span class="id" title="lemma">Nat.succ_le_mono</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <span class="id" title="var">l</span>) <span class="id" title="keyword">with</span> 0 <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="var">destree</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <span class="id" title="var">r</span>) <span class="id" title="keyword">with</span> 0 <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="var">destree</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.min_glb"><span class="id" title="lemma">Nat.min_glb</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">apply</span> → <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_le_mono"><span class="id" title="lemma">Nat.succ_le_mono</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.min_glb"><span class="id" title="lemma">Nat.min_glb</span></a>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.maxdepth_upperbound" class="idref" href="#BalanceProps.maxdepth_upperbound"><span class="id" title="lemma">maxdepth_upperbound</span></a> <a id="s:45" class="idref" href="#s:45"><span class="id" title="binder">s</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:45"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.maxdepth"><span class="id" title="definition">maxdepth</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:45"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> 2 <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.log2"><span class="id" title="definition">Nat.log2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.cardinal"><span class="id" title="definition">cardinal</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:45"><span class="id" title="variable">s</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">n</span>,<span class="id" title="var">H</span>).<br/>
&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.le_trans"><span class="id" title="lemma">Nat.le_trans</span></a>; [<span class="id" title="tactic">eapply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rb_maxdepth"><span class="id" title="lemma">rb_maxdepth</span></a>; <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;<span class="id" title="tactic">transitivity</span> (2<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">*(</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.redcarac"><span class="id" title="definition">redcarac</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.mul_add_distr_l"><span class="id" title="lemma">Nat.mul_add_distr_l</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_le_mono_l"><span class="id" title="lemma">Nat.add_le_mono_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.mul_1_l"><span class="id" title="lemma">Nat.mul_1_l</span></a> <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.mul_le_mono_r"><span class="id" title="lemma">Nat.mul_le_mono_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.mul_le_mono_l"><span class="id" title="lemma">Nat.mul_le_mono_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.mindepth"><span class="id" title="definition">mindepth</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rb_mindepth"><span class="id" title="lemma">rb_mindepth</span></a>.<br/>
&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.mindepth_log_cardinal"><span class="id" title="lemma">mindepth_log_cardinal</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.maxdepth_lowerbound" class="idref" href="#BalanceProps.maxdepth_lowerbound"><span class="id" title="lemma">maxdepth_lowerbound</span></a> <a id="s:46" class="idref" href="#s:46"><span class="id" title="binder">s</span></a> : <a class="idref" href="MMaps.RBTproofs.html#s:46"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Leaf"><span class="id" title="constructor">Leaf</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.log2"><span class="id" title="definition">Nat.log2</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.cardinal"><span class="id" title="definition">cardinal</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:46"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.maxdepth"><span class="id" title="definition">maxdepth</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:46"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.maxdepth_log_cardinal"><span class="id" title="lemma">maxdepth_log_cardinal</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab138"></a><h2 class="section">Singleton</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.singleton_rb" class="idref" href="#BalanceProps.singleton_rb"><span class="id" title="lemma">singleton_rb</span></a> <a id="x:47" class="idref" href="#x:47"><span class="id" title="binder">x</span></a> <a id="e:48" class="idref" href="#e:48"><span class="id" title="binder">e</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.singleton"><span class="id" title="definition">singleton</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:47"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:48"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.singleton"><span class="id" title="definition">singleton</span></a>. <span class="id" title="tactic">∃</span> 1; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab139"></a><h2 class="section">makeBlack and makeRed</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.makeBlack_rb" class="idref" href="#BalanceProps.makeBlack_rb"><span class="id" title="lemma">makeBlack_rb</span></a> <a id="n:49" class="idref" href="#n:49"><span class="id" title="binder">n</span></a> <a id="t:50" class="idref" href="#t:50"><span class="id" title="binder">t</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:49"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:50"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeBlack"><span class="id" title="definition">makeBlack</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:50"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>].<br/>
&nbsp;- <span class="id" title="tactic">∃</span> 0; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">destruct</span> 1; <span class="id" title="var">invrb</span>; <span class="id" title="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">∃</span> <span class="id" title="var">n</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.makeRed_rr" class="idref" href="#BalanceProps.makeRed_rr"><span class="id" title="lemma">makeRed_rr</span></a> <a id="t:51" class="idref" href="#t:51"><span class="id" title="binder">t</span></a> <a id="n:52" class="idref" href="#n:52"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:52"><span class="id" title="variable">n</span></a>) <a class="idref" href="MMaps.RBTproofs.html#t:51"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:51"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rrt"><span class="id" title="inductive">rrt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:52"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeRed"><span class="id" title="definition">makeRed</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:51"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>]; <span class="id" title="var">invrb</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab140"></a><h2 class="section">Balancing</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.lbal_rb" class="idref" href="#BalanceProps.lbal_rb"><span class="id" title="lemma">lbal_rb</span></a> <a id="n:53" class="idref" href="#n:53"><span class="id" title="binder">n</span></a> <a id="l:54" class="idref" href="#l:54"><span class="id" title="binder">l</span></a> <a id="k:55" class="idref" href="#k:55"><span class="id" title="binder">k</span></a> <a id="e:56" class="idref" href="#e:56"><span class="id" title="binder">e</span></a> <a id="r:57" class="idref" href="#r:57"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:53"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:54"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:53"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:57"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:53"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbal"><span class="id" title="definition">lbal</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:54"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#k:55"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:56"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:57"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbal_match"><span class="id" title="lemma">lbal_match</span></a>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">desarb</span>; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rbal_rb" class="idref" href="#BalanceProps.rbal_rb"><span class="id" title="lemma">rbal_rb</span></a> <a id="n:58" class="idref" href="#n:58"><span class="id" title="binder">n</span></a> <a id="l:59" class="idref" href="#l:59"><span class="id" title="binder">l</span></a> <a id="k:60" class="idref" href="#k:60"><span class="id" title="binder">k</span></a> <a id="e:61" class="idref" href="#e:61"><span class="id" title="binder">e</span></a> <a id="r:62" class="idref" href="#r:62"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:58"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:59"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:58"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:62"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:58"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal"><span class="id" title="definition">rbal</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:59"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#k:60"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:61"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:62"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal_match"><span class="id" title="lemma">rbal_match</span></a>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">desarb</span>; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rbal'_rb" class="idref" href="#BalanceProps.rbal'_rb"><span class="id" title="lemma">rbal'_rb</span></a> <a id="n:63" class="idref" href="#n:63"><span class="id" title="binder">n</span></a> <a id="l:64" class="idref" href="#l:64"><span class="id" title="binder">l</span></a> <a id="k:65" class="idref" href="#k:65"><span class="id" title="binder">k</span></a> <a id="e:66" class="idref" href="#e:66"><span class="id" title="binder">e</span></a> <a id="r:67" class="idref" href="#r:67"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:63"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:64"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:63"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:67"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:63"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal'"><span class="id" title="definition">rbal'</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:64"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#k:65"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:66"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:67"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal'_match"><span class="id" title="lemma">rbal'_match</span></a>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">desarb</span>; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.lbalS_rb" class="idref" href="#BalanceProps.lbalS_rb"><span class="id" title="lemma">lbalS_rb</span></a> <a id="n:68" class="idref" href="#n:68"><span class="id" title="binder">n</span></a> <a id="l:69" class="idref" href="#l:69"><span class="id" title="binder">l</span></a> <a id="x:70" class="idref" href="#x:70"><span class="id" title="binder">x</span></a> <a id="e:71" class="idref" href="#e:71"><span class="id" title="binder">e</span></a> <a id="r:72" class="idref" href="#r:72"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:68"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:69"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:68"><span class="id" title="variable">n</span></a>) <a class="idref" href="MMaps.RBTproofs.html#r:72"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:72"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:68"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS"><span class="id" title="definition">lbalS</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:69"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:70"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:71"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:72"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hr'</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>]; <span class="id" title="var">invrb</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hr'</span>.<br/>
&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS_match"><span class="id" title="lemma">lbalS_match</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">destruct</span> 1; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal'_rb"><span class="id" title="lemma">rbal'_rb</span></a>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.lbalS_arb" class="idref" href="#BalanceProps.lbalS_arb"><span class="id" title="lemma">lbalS_arb</span></a> <a id="n:73" class="idref" href="#n:73"><span class="id" title="binder">n</span></a> <a id="l:74" class="idref" href="#l:74"><span class="id" title="binder">l</span></a> <a id="x:75" class="idref" href="#x:75"><span class="id" title="binder">x</span></a> <a id="e:76" class="idref" href="#e:76"><span class="id" title="binder">e</span></a> <a id="r:77" class="idref" href="#r:77"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:73"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:74"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:73"><span class="id" title="variable">n</span></a>) <a class="idref" href="MMaps.RBTproofs.html#r:77"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:73"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS"><span class="id" title="definition">lbalS</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:74"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:75"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:76"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:77"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS_match"><span class="id" title="lemma">lbalS_match</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">destruct</span> 1; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hl'</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>]; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">rl</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">rll</span> <span class="id" title="var">rlx</span> <span class="id" title="var">rlv</span> <span class="id" title="var">rlr</span>]; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal'_rb"><span class="id" title="lemma">rbal'_rb</span></a>, <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeRed_rr"><span class="id" title="lemma">makeRed_rr</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>.<br/>
&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">left</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal'_rb"><span class="id" title="lemma">rbal'_rb</span></a>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rbalS_rb" class="idref" href="#BalanceProps.rbalS_rb"><span class="id" title="lemma">rbalS_rb</span></a> <a id="n:78" class="idref" href="#n:78"><span class="id" title="binder">n</span></a> <a id="l:79" class="idref" href="#l:79"><span class="id" title="binder">l</span></a> <a id="x:80" class="idref" href="#x:80"><span class="id" title="binder">x</span></a> <a id="e:81" class="idref" href="#e:81"><span class="id" title="binder">e</span></a> <a id="r:82" class="idref" href="#r:82"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:78"><span class="id" title="variable">n</span></a>) <a class="idref" href="MMaps.RBTproofs.html#l:79"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:79"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:78"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:82"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:78"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbalS"><span class="id" title="definition">rbalS</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:79"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:80"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:81"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:82"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hl'</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>]; <span class="id" title="var">invrb</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hl'</span>.<br/>
&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbalS_match"><span class="id" title="lemma">rbalS_match</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">destruct</span> 1; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbal_rb"><span class="id" title="lemma">lbal_rb</span></a>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.rbalS_arb" class="idref" href="#BalanceProps.rbalS_arb"><span class="id" title="lemma">rbalS_arb</span></a> <a id="n:83" class="idref" href="#n:83"><span class="id" title="binder">n</span></a> <a id="l:84" class="idref" href="#l:84"><span class="id" title="binder">l</span></a> <a id="x:85" class="idref" href="#x:85"><span class="id" title="binder">x</span></a> <a id="e:86" class="idref" href="#e:86"><span class="id" title="binder">e</span></a> <a id="r:87" class="idref" href="#r:87"><span class="id" title="binder">r</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:83"><span class="id" title="variable">n</span></a>) <a class="idref" href="MMaps.RBTproofs.html#l:84"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:83"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:87"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:83"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbalS"><span class="id" title="definition">rbalS</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:84"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:85"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:86"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:87"><span class="id" title="variable">r</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbalS_match"><span class="id" title="lemma">rbalS_match</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">destruct</span> 2; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hr'</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>]; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <span class="id" title="var">lr</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">lrl</span> <span class="id" title="var">lrx</span> <span class="id" title="var">lrv</span> <span class="id" title="var">lrr</span>]; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbal_rb"><span class="id" title="lemma">lbal_rb</span></a>, <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeRed_rr"><span class="id" title="lemma">makeRed_rr</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>.<br/>
&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">left</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbal_rb"><span class="id" title="lemma">lbal_rb</span></a>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab141"></a><h2 class="section">Insertion</h2>

<div class="paragraph"> </div>

 The next lemmas combine simultaneous results about rbt and arbt.
    A first solution here: statement with <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="BalanceProps.ifred" class="idref" href="#BalanceProps.ifred"><span class="id" title="definition">ifred</span></a> <a id="s:88" class="idref" href="#s:88"><span class="id" title="binder">s</span></a> (<a id="A:89" class="idref" href="#A:89"><span class="id" title="binder">A</span></a> <a id="B:90" class="idref" href="#B:90"><span class="id" title="binder">B</span></a>:<span class="id" title="keyword">Prop</span>) := <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rcase"><span class="id" title="definition">rcase</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MMaps.RBTproofs.html#A:89"><span class="id" title="variable">A</span></a>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MMaps.RBTproofs.html#B:90"><span class="id" title="variable">B</span></a>) <a class="idref" href="MMaps.RBTproofs.html#s:88"><span class="id" title="variable">s</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.ifred_notred" class="idref" href="#BalanceProps.ifred_notred"><span class="id" title="lemma">ifred_notred</span></a> <a id="s:91" class="idref" href="#s:91"><span class="id" title="binder">s</span></a> <a id="A:92" class="idref" href="#A:92"><span class="id" title="binder">A</span></a> <a id="B:93" class="idref" href="#B:93"><span class="id" title="binder">B</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:91"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred"><span class="id" title="definition">ifred</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:91"><span class="id" title="variable">s</span></a> <a class="idref" href="MMaps.RBTproofs.html#A:92"><span class="id" title="variable">A</span></a> <a class="idref" href="MMaps.RBTproofs.html#B:93"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="MMaps.RBTproofs.html#B:93"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>; <span class="id" title="var">descolor</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.ifred_or" class="idref" href="#BalanceProps.ifred_or"><span class="id" title="lemma">ifred_or</span></a> <a id="s:94" class="idref" href="#s:94"><span class="id" title="binder">s</span></a> <a id="A:95" class="idref" href="#A:95"><span class="id" title="binder">A</span></a> <a id="B:96" class="idref" href="#B:96"><span class="id" title="binder">B</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred"><span class="id" title="definition">ifred</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:94"><span class="id" title="variable">s</span></a> <a class="idref" href="MMaps.RBTproofs.html#A:95"><span class="id" title="variable">A</span></a> <a class="idref" href="MMaps.RBTproofs.html#B:96"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#A:95"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a><a class="idref" href="MMaps.RBTproofs.html#B:96"><span class="id" title="variable">B</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>; <span class="id" title="var">descolor</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.ins_rr_rb" class="idref" href="#BalanceProps.ins_rr_rb"><span class="id" title="lemma">ins_rr_rb</span></a> <a id="x:97" class="idref" href="#x:97"><span class="id" title="binder">x</span></a> <a id="e:98" class="idref" href="#e:98"><span class="id" title="binder">e</span></a> <a id="s:99" class="idref" href="#s:99"><span class="id" title="binder">s</span></a> <a id="n:100" class="idref" href="#n:100"><span class="id" title="binder">n</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:100"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:99"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred"><span class="id" title="definition">ifred</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:99"><span class="id" title="variable">s</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rrt"><span class="id" title="inductive">rrt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:100"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:97"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:98"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:99"><span class="id" title="variable">s</span></a>)) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:100"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:97"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:98"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:99"><span class="id" title="variable">s</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> 1 <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">l</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> | <span class="id" title="var">n</span> <span class="id" title="var">l</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">Hl</span> <span class="id" title="var">IHl</span> <span class="id" title="var">Hr</span> <span class="id" title="var">IHr</span> ].<br/>
- <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred_notred"><span class="id" title="lemma">ifred_notred</span></a> <span class="id" title="tactic">in</span> × <span class="id" title="tactic">by</span> <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destmatch</span>; <span class="id" title="var">autom</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred_notred"><span class="id" title="lemma">ifred_notred</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="var">destmatch</span>; <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;× <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbal_rb"><span class="id" title="lemma">lbal_rb</span></a>; <span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred_or"><span class="id" title="lemma">ifred_or</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">intuition</span> (<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>).<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbal_rb"><span class="id" title="lemma">rbal_rb</span></a>; <span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred_or"><span class="id" title="lemma">ifred_or</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHr</span>; <span class="id" title="tactic">intuition</span> (<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.ins_arb" class="idref" href="#BalanceProps.ins_arb"><span class="id" title="lemma">ins_arb</span></a> <a id="x:101" class="idref" href="#x:101"><span class="id" title="binder">x</span></a> <a id="e:102" class="idref" href="#e:102"><span class="id" title="binder">e</span></a> <a id="s:103" class="idref" href="#s:103"><span class="id" title="binder">s</span></a> <a id="n:104" class="idref" href="#n:104"><span class="id" title="binder">n</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:104"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:103"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:104"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:101"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:102"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:103"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ins_rr_rb"><span class="id" title="lemma">ins_rr_rb</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span>), <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifred_or"><span class="id" title="lemma">ifred_or</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intuition</span> (<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.add_rb" class="idref" href="#BalanceProps.add_rb"><span class="id" title="instance">add_rb</span></a> <a id="x:105" class="idref" href="#x:105"><span class="id" title="binder">x</span></a> <a id="e:106" class="idref" href="#e:106"><span class="id" title="binder">e</span></a> <a id="s:107" class="idref" href="#s:107"><span class="id" title="binder">s</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:107"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.add"><span class="id" title="definition">add</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:105"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:106"><span class="id" title="variable">e</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:107"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">n</span>,<span class="id" title="var">H</span>). <span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.add"><span class="id" title="definition">add</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeBlack_rb"><span class="id" title="lemma">makeBlack_rb</span></a> <span class="id" title="var">n</span>), <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ins_arb"><span class="id" title="lemma">ins_arb</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab142"></a><h2 class="section">Deletion</h2>

</div>
<div class="code">

<br/>
<span class="comment">(*TODO:&nbsp;share&nbsp;with&nbsp;RBT&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">append_tac</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">lc</span> <span class="id" title="var">ll</span> <span class="id" title="var">_</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span> <span class="id" title="var">IHlr</span>];<br/>
&nbsp;[<span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">simpl</span><br/>
&nbsp;|<span class="id" title="tactic">induction</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">rc</span> <span class="id" title="var">rl</span> <span class="id" title="var">IHrl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span> <span class="id" title="var">_</span>];<br/>
&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">destruct</span> <span class="id" title="var">lc</span>, <span class="id" title="var">rc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHlr</span> <span class="id" title="var">rl</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IHrl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hr</span>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">trivial</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">r</span>:=<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHrl</span> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHlr</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">change</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>) <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hl</span>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">trivial</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">l</span>:=<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHlr</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHlr</span> <span class="id" title="var">rl</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IHrl</span>]]].<br/>

<br/>
<span class="id" title="keyword">Fact</span> <a id="BalanceProps.append_rr_match" class="idref" href="#BalanceProps.append_rr_match"><span class="id" title="lemma">append_rr_match</span></a> <a id="ll:108" class="idref" href="#ll:108"><span class="id" title="binder">ll</span></a> <a id="lx:109" class="idref" href="#lx:109"><span class="id" title="binder">lx</span></a> <a id="lv:110" class="idref" href="#lv:110"><span class="id" title="binder">lv</span></a> <a id="lr:111" class="idref" href="#lr:111"><span class="id" title="binder">lr</span></a> <a id="rl:112" class="idref" href="#rl:112"><span class="id" title="binder">rl</span></a> <a id="rx:113" class="idref" href="#rx:113"><span class="id" title="binder">rx</span></a> <a id="rv:114" class="idref" href="#rv:114"><span class="id" title="binder">rv</span></a> <a id="rr:115" class="idref" href="#rr:115"><span class="id" title="binder">rr</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rspec"><span class="id" title="inductive">rspec</span></a><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="a:117" class="idref" href="#a:117"><span class="id" title="binder">a</span></a> <a id="x:118" class="idref" href="#x:118"><span class="id" title="binder">x</span></a> <a id="e:119" class="idref" href="#e:119"><span class="id" title="binder">e</span></a> <a id="b:120" class="idref" href="#b:120"><span class="id" title="binder">b</span></a> ⇒ <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#ll:108"><span class="id" title="variable">ll</span></a> <a class="idref" href="MMaps.RBTproofs.html#lx:109"><span class="id" title="variable">lx</span></a> <a class="idref" href="MMaps.RBTproofs.html#lv:110"><span class="id" title="variable">lv</span></a> <a class="idref" href="MMaps.RBTproofs.html#a:117"><span class="id" title="variable">a</span></a>) <a class="idref" href="MMaps.RBTproofs.html#x:118"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:119"><span class="id" title="variable">e</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#b:120"><span class="id" title="variable">b</span></a> <a class="idref" href="MMaps.RBTproofs.html#rx:113"><span class="id" title="variable">rx</span></a> <a class="idref" href="MMaps.RBTproofs.html#rv:114"><span class="id" title="variable">rv</span></a> <a class="idref" href="MMaps.RBTproofs.html#rr:115"><span class="id" title="variable">rr</span></a>))<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="t:116" class="idref" href="#t:116"><span class="id" title="binder">t</span></a> ⇒ <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#ll:108"><span class="id" title="variable">ll</span></a> <a class="idref" href="MMaps.RBTproofs.html#lx:109"><span class="id" title="variable">lx</span></a> <a class="idref" href="MMaps.RBTproofs.html#lv:110"><span class="id" title="variable">lv</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:116"><span class="id" title="variable">t</span></a> <a class="idref" href="MMaps.RBTproofs.html#rx:113"><span class="id" title="variable">rx</span></a> <a class="idref" href="MMaps.RBTproofs.html#rv:114"><span class="id" title="variable">rv</span></a> <a class="idref" href="MMaps.RBTproofs.html#rr:115"><span class="id" title="variable">rr</span></a>))<br/>
&nbsp;&nbsp;(<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> <a class="idref" href="MMaps.RBTproofs.html#lr:111"><span class="id" title="variable">lr</span></a> <a class="idref" href="MMaps.RBTproofs.html#rl:112"><span class="id" title="variable">rl</span></a>)<br/>
&nbsp;&nbsp;(<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#ll:108"><span class="id" title="variable">ll</span></a> <a class="idref" href="MMaps.RBTproofs.html#lx:109"><span class="id" title="variable">lx</span></a> <a class="idref" href="MMaps.RBTproofs.html#lv:110"><span class="id" title="variable">lv</span></a> <a class="idref" href="MMaps.RBTproofs.html#lr:111"><span class="id" title="variable">lr</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <a class="idref" href="MMaps.RBTproofs.html#rl:112"><span class="id" title="variable">rl</span></a> <a class="idref" href="MMaps.RBTproofs.html#rx:113"><span class="id" title="variable">rx</span></a> <a class="idref" href="MMaps.RBTproofs.html#rv:114"><span class="id" title="variable">rv</span></a> <a class="idref" href="MMaps.RBTproofs.html#rr:115"><span class="id" title="variable">rr</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">exact</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rmatch"><span class="id" title="lemma">rmatch</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <a id="BalanceProps.append_bb_match" class="idref" href="#BalanceProps.append_bb_match"><span class="id" title="lemma">append_bb_match</span></a> <a id="ll:121" class="idref" href="#ll:121"><span class="id" title="binder">ll</span></a> <a id="lx:122" class="idref" href="#lx:122"><span class="id" title="binder">lx</span></a> <a id="lv:123" class="idref" href="#lv:123"><span class="id" title="binder">lv</span></a> <a id="lr:124" class="idref" href="#lr:124"><span class="id" title="binder">lr</span></a> <a id="rl:125" class="idref" href="#rl:125"><span class="id" title="binder">rl</span></a> <a id="rx:126" class="idref" href="#rx:126"><span class="id" title="binder">rx</span></a> <a id="rv:127" class="idref" href="#rv:127"><span class="id" title="binder">rv</span></a> <a id="rr:128" class="idref" href="#rr:128"><span class="id" title="binder">rr</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rspec"><span class="id" title="inductive">rspec</span></a><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="a:130" class="idref" href="#a:130"><span class="id" title="binder">a</span></a> <a id="x:131" class="idref" href="#x:131"><span class="id" title="binder">x</span></a> <a id="e:132" class="idref" href="#e:132"><span class="id" title="binder">e</span></a> <a id="b:133" class="idref" href="#b:133"><span class="id" title="binder">b</span></a> ⇒ <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <a class="idref" href="MMaps.RBTproofs.html#ll:121"><span class="id" title="variable">ll</span></a> <a class="idref" href="MMaps.RBTproofs.html#lx:122"><span class="id" title="variable">lx</span></a> <a class="idref" href="MMaps.RBTproofs.html#lv:123"><span class="id" title="variable">lv</span></a> <a class="idref" href="MMaps.RBTproofs.html#a:130"><span class="id" title="variable">a</span></a>) <a class="idref" href="MMaps.RBTproofs.html#x:131"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#e:132"><span class="id" title="variable">e</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <a class="idref" href="MMaps.RBTproofs.html#b:133"><span class="id" title="variable">b</span></a> <a class="idref" href="MMaps.RBTproofs.html#rx:126"><span class="id" title="variable">rx</span></a> <a class="idref" href="MMaps.RBTproofs.html#rv:127"><span class="id" title="variable">rv</span></a> <a class="idref" href="MMaps.RBTproofs.html#rr:128"><span class="id" title="variable">rr</span></a>))<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="t:129" class="idref" href="#t:129"><span class="id" title="binder">t</span></a> ⇒ <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS"><span class="id" title="definition">lbalS</span></a> <a class="idref" href="MMaps.RBTproofs.html#ll:121"><span class="id" title="variable">ll</span></a> <a class="idref" href="MMaps.RBTproofs.html#lx:122"><span class="id" title="variable">lx</span></a> <a class="idref" href="MMaps.RBTproofs.html#lv:123"><span class="id" title="variable">lv</span></a>  (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <a class="idref" href="MMaps.RBTproofs.html#t:129"><span class="id" title="variable">t</span></a> <a class="idref" href="MMaps.RBTproofs.html#rx:126"><span class="id" title="variable">rx</span></a> <a class="idref" href="MMaps.RBTproofs.html#rv:127"><span class="id" title="variable">rv</span></a> <a class="idref" href="MMaps.RBTproofs.html#rr:128"><span class="id" title="variable">rr</span></a>))<br/>
&nbsp;&nbsp;(<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> <a class="idref" href="MMaps.RBTproofs.html#lr:124"><span class="id" title="variable">lr</span></a> <a class="idref" href="MMaps.RBTproofs.html#rl:125"><span class="id" title="variable">rl</span></a>)<br/>
&nbsp;&nbsp;(<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <a class="idref" href="MMaps.RBTproofs.html#ll:121"><span class="id" title="variable">ll</span></a> <a class="idref" href="MMaps.RBTproofs.html#lx:122"><span class="id" title="variable">lx</span></a> <a class="idref" href="MMaps.RBTproofs.html#lv:123"><span class="id" title="variable">lv</span></a> <a class="idref" href="MMaps.RBTproofs.html#lr:124"><span class="id" title="variable">lr</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Bk"><span class="id" title="abbreviation">Bk</span></a> <a class="idref" href="MMaps.RBTproofs.html#rl:125"><span class="id" title="variable">rl</span></a> <a class="idref" href="MMaps.RBTproofs.html#rx:126"><span class="id" title="variable">rx</span></a> <a class="idref" href="MMaps.RBTproofs.html#rv:127"><span class="id" title="variable">rv</span></a> <a class="idref" href="MMaps.RBTproofs.html#rr:128"><span class="id" title="variable">rr</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">exact</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rmatch"><span class="id" title="lemma">rmatch</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
A second approach here: statement with ... /\ ... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.append_arb_rb" class="idref" href="#BalanceProps.append_arb_rb"><span class="id" title="lemma">append_arb_rb</span></a> <a id="n:134" class="idref" href="#n:134"><span class="id" title="binder">n</span></a> <a id="l:135" class="idref" href="#l:135"><span class="id" title="binder">l</span></a> <a id="r:136" class="idref" href="#r:136"><span class="id" title="binder">r</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:134"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:135"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:134"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:136"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:134"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:135"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:136"><span class="id" title="variable">r</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:135"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notred"><span class="id" title="definition">notred</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:136"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:134"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append"><span class="id" title="definition">append</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:135"><span class="id" title="variable">l</span></a> <a class="idref" href="MMaps.RBTproofs.html#r:136"><span class="id" title="variable">r</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="var">revert</span> <span class="id" title="var">r</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="var">append_tac</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>.<br/>
- <span class="id" title="tactic">split</span>; <span class="id" title="var">autom</span>.<br/>
- <span class="id" title="tactic">split</span>; <span class="id" title="var">autom</span>.<br/>
- <span class="comment">(*&nbsp;Red&nbsp;/&nbsp;Red&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span> (<span class="id" title="var">IHlr</span> <span class="id" title="var">n</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHlr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append_rr_match"><span class="id" title="lemma">append_rr_match</span></a>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">split</span>; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <span class="id" title="var">n</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rd"><span class="id" title="abbreviation">Rd</span></a> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="var">b</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">autom</span>. <span class="id" title="var">invrb</span>. <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
- <span class="comment">(*&nbsp;Red&nbsp;/&nbsp;Black&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">invrb</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHlr</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span>,<span class="id" title="var">IH</span>); <span class="id" title="var">autom</span>.<br/>
- <span class="comment">(*&nbsp;Black&nbsp;/&nbsp;Red&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">invrb</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHrl</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span>,<span class="id" title="var">IH</span>); <span class="id" title="var">autom</span>.<br/>
- <span class="comment">(*&nbsp;Black&nbsp;/&nbsp;Black&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">nonzero</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHlr</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">IH</span>,<span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHlr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append_bb_match"><span class="id" title="lemma">append_bb_match</span></a>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="var">b</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span>; <span class="id" title="var">invrb</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">left</span> | <span class="id" title="var">invrb</span>]; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS_rb"><span class="id" title="lemma">lbalS_rb</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">map</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">induct'</span> <span class="id" title="var">m</span> :=<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span> <span class="id" title="var">x'</span> <span class="id" title="var">vx'</span> <span class="id" title="var">r</span> <span class="id" title="var">IHr</span>]; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;[|<span class="id" title="tactic">case</span> <a class="idref" href="MMaps.RBTproofs.html#K.compare_spec"><span class="id" title="axiom">K.compare_spec</span></a>; <span class="id" title="tactic">intros</span>].<br/>

<br/>
</div>

<div class="doc">
A third approach : Lemma ... with ... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.del_arb" class="idref" href="#BalanceProps.del_arb"><span class="id" title="lemma">del_arb</span></a> <a id="s:137" class="idref" href="#s:137"><span class="id" title="binder">s</span></a> <a id="x:138" class="idref" href="#x:138"><span class="id" title="binder">x</span></a> <a id="n:139" class="idref" href="#n:139"><span class="id" title="binder">n</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:139"><span class="id" title="variable">n</span></a>) <a class="idref" href="MMaps.RBTproofs.html#s:137"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.isblack"><span class="id" title="definition">isblack</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:137"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.arbt"><span class="id" title="inductive">arbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:139"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.del"><span class="id" title="definition">del</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:138"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:137"><span class="id" title="variable">s</span></a>)<br/>
<span class="id" title="keyword">with</span> <a id="BalanceProps.del_rb" class="idref" href="#BalanceProps.del_rb"><span class="id" title="lemma">del_rb</span></a> <a id="s:140" class="idref" href="#s:140"><span class="id" title="binder">s</span></a> <a id="x:141" class="idref" href="#x:141"><span class="id" title="binder">x</span></a> <a id="n:142" class="idref" href="#n:142"><span class="id" title="binder">n</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:142"><span class="id" title="variable">n</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:140"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.notblack"><span class="id" title="definition">notblack</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:140"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:142"><span class="id" title="variable">n</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.del"><span class="id" title="definition">del</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:141"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:140"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
{ <span class="id" title="var">revert</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">induct'</span> <span class="id" title="var">s</span>; <span class="id" title="var">descolor</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append_arb_rb"><span class="id" title="lemma">append_arb_rb</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">IHl'</span> := <span class="id" title="var">del_rb</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">IHr</span> <span class="id" title="var">del_arb</span> <span class="id" title="var">del_rb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>]; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nonzero</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS_arb"><span class="id" title="lemma">lbalS_arb</span></a>; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">IHr'</span> := <span class="id" title="var">del_rb</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">IHl</span> <span class="id" title="var">del_arb</span> <span class="id" title="var">del_rb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>]; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nonzero</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbalS_arb"><span class="id" title="lemma">rbalS_arb</span></a>; <span class="id" title="tactic">auto</span>. }<br/>
{ <span class="id" title="var">revert</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">induct'</span> <span class="id" title="var">s</span>; <span class="id" title="var">descolor</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="var">invrb</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.append_arb_rb"><span class="id" title="lemma">append_arb_rb</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">IHl'</span> := <span class="id" title="var">del_arb</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">IHr</span> <span class="id" title="var">del_arb</span> <span class="id" title="var">del_rb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lv</span> <span class="id" title="var">lr</span>]; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nonzero</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span>]; [<span class="id" title="var">invrb</span>|]; <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.lbalS_rb"><span class="id" title="lemma">lbalS_rb</span></a>; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">IHr'</span> := <span class="id" title="var">del_arb</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">IHl</span> <span class="id" title="var">del_arb</span> <span class="id" title="var">del_rb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rv</span> <span class="id" title="var">rr</span>]; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nonzero</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbalS_rb"><span class="id" title="lemma">rbalS_rb</span></a>; <span class="id" title="tactic">auto</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.remove_rb" class="idref" href="#BalanceProps.remove_rb"><span class="id" title="instance">remove_rb</span></a> <a id="s:143" class="idref" href="#s:143"><span class="id" title="binder">s</span></a> <a id="x:144" class="idref" href="#x:144"><span class="id" title="binder">x</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:143"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="MMaps.RBTproofs.html#x:144"><span class="id" title="variable">x</span></a> <a class="idref" href="MMaps.RBTproofs.html#s:143"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">n</span>,<span class="id" title="var">H</span>). <span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.remove"><span class="id" title="definition">remove</span></a>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span>].<br/>
&nbsp;- <span class="id" title="tactic">apply</span> (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeBlack_rb"><span class="id" title="lemma">makeBlack_rb</span></a> <span class="id" title="var">n</span>). <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="tactic">apply</span> (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeBlack_rb"><span class="id" title="lemma">makeBlack_rb</span></a> <span class="id" title="var">n</span>). <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.del_rb"><span class="id" title="lemma">del_rb</span></a>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;- <span class="id" title="var">nonzero</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.makeBlack_rb"><span class="id" title="lemma">makeBlack_rb</span></a> <span class="id" title="var">n</span>). <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.del_arb"><span class="id" title="lemma">del_arb</span></a>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab143"></a><h2 class="section">Treeify</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Notation</span> <a id="BalanceProps.ifpred" class="idref" href="#BalanceProps.ifpred"><span class="id" title="abbreviation">ifpred</span></a> <span class="id" title="var">p</span> <span class="id" title="var">n</span> := (<span class="id" title="keyword">if</span> <span class="id" title="var">p</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a> <span class="id" title="var">n</span> <span class="id" title="keyword">else</span> <span class="id" title="var">n</span>%<span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Local Notation</span> <a id="BalanceProps.treeify_t" class="idref" href="#BalanceProps.treeify_t"><span class="id" title="abbreviation">treeify_t</span></a> := (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.klist"><span class="id" title="definition">klist</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.klist"><span class="id" title="definition">klist</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="BalanceProps.treeify_rb_invariant" class="idref" href="#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> <a id="size:145" class="idref" href="#size:145"><span class="id" title="binder">size</span></a> <a id="depth:146" class="idref" href="#depth:146"><span class="id" title="binder">depth</span></a> (<a id="f:147" class="idref" href="#f:147"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_t"><span class="id" title="abbreviation">treeify_t</span></a>) :=<br/>
&nbsp;<span class="id" title="keyword">∀</span> <a id="acc:148" class="idref" href="#acc:148"><span class="id" title="binder">acc</span></a>,<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#size:145"><span class="id" title="variable">size</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="MMaps.RBTproofs.html#acc:148"><span class="id" title="variable">acc</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.rbt"><span class="id" title="inductive">rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#depth:146"><span class="id" title="variable">depth</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="MMaps.RBTproofs.html#f:147"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#acc:148"><span class="id" title="variable">acc</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MMaps.RBTproofs.html#size:145"><span class="id" title="variable">size</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="MMaps.RBTproofs.html#f:147"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#acc:148"><span class="id" title="variable">acc</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="MMaps.RBTproofs.html#acc:148"><span class="id" title="variable">acc</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.treeify_zero_rb" class="idref" href="#BalanceProps.treeify_zero_rb"><span class="id" title="lemma">treeify_zero_rb</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> 0 0 (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_zero"><span class="id" title="definition">treeify_zero</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.treeify_one_rb" class="idref" href="#BalanceProps.treeify_one_rb"><span class="id" title="lemma">treeify_one_rb</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> 1 0 (@<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_one"><span class="id" title="definition">treeify_one</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> [|(<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) <span class="id" title="var">acc</span>]; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">autom</span>; <span class="id" title="tactic">inversion</span> 1.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.treeify_cont_rb" class="idref" href="#BalanceProps.treeify_cont_rb"><span class="id" title="lemma">treeify_cont_rb</span></a> <a id="f:149" class="idref" href="#f:149"><span class="id" title="binder">f</span></a> <a id="g:150" class="idref" href="#g:150"><span class="id" title="binder">g</span></a> <a id="size1:151" class="idref" href="#size1:151"><span class="id" title="binder">size1</span></a> <a id="size2:152" class="idref" href="#size2:152"><span class="id" title="binder">size2</span></a> <a id="size:153" class="idref" href="#size:153"><span class="id" title="binder">size</span></a> <a id="d:154" class="idref" href="#d:154"><span class="id" title="binder">d</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> <a class="idref" href="MMaps.RBTproofs.html#size1:151"><span class="id" title="variable">size1</span></a> <a class="idref" href="MMaps.RBTproofs.html#d:154"><span class="id" title="variable">d</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:149"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> <a class="idref" href="MMaps.RBTproofs.html#size2:152"><span class="id" title="variable">size2</span></a> <a class="idref" href="MMaps.RBTproofs.html#d:154"><span class="id" title="variable">d</span></a> <a class="idref" href="MMaps.RBTproofs.html#g:150"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#size:153"><span class="id" title="variable">size</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="MMaps.RBTproofs.html#size1:151"><span class="id" title="variable">size1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MMaps.RBTproofs.html#size2:152"><span class="id" title="variable">size2</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> <a class="idref" href="MMaps.RBTproofs.html#size:153"><span class="id" title="variable">size</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MMaps.RBTproofs.html#d:154"><span class="id" title="variable">d</span></a>) (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_cont"><span class="id" title="definition">treeify_cont</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:149"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#g:150"><span class="id" title="variable">g</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hf</span> <span class="id" title="var">Hg</span> <span class="id" title="var">H</span> <span class="id" title="var">acc</span> <span class="id" title="var">Hacc</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_cont"><span class="id" title="definition">treeify_cont</span></a>.<br/>
&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hf</span> <span class="id" title="var">acc</span>).<br/>
&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">acc</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">l</span>, <span class="id" title="var">acc1</span>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hf</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hf1</span>, <span class="id" title="var">Hf2</span>). { <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>. }<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">acc1</span> <span class="id" title="keyword">as</span> [|(<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) <span class="id" title="var">acc2</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;- <span class="id" title="var">exfalso</span>. <span class="id" title="var">revert</span> <span class="id" title="var">Hacc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.lt_nge"><span class="id" title="lemma">Nat.lt_nge</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, &lt;- <span class="id" title="var">Hf2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hg</span> <span class="id" title="var">acc2</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">g</span> <span class="id" title="var">acc2</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">r</span>, <span class="id" title="var">acc3</span>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hg1</span>, <span class="id" title="var">Hg2</span>).<br/>
&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">revert</span> <span class="id" title="var">Hacc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, &lt;- <span class="id" title="var">Hf2</span>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>, &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_le_mono"><span class="id" title="lemma">Nat.succ_le_mono</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_le_mono_l"><span class="id" title="lemma">Nat.add_le_mono_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">autom</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, &lt;- <span class="id" title="var">Hf2</span>, &lt;- <span class="id" title="var">Hg2</span>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_assoc"><span class="id" title="lemma">Nat.add_assoc</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="BalanceProps.treeify_aux_rb" class="idref" href="#BalanceProps.treeify_aux_rb"><span class="id" title="lemma">treeify_aux_rb</span></a> <a id="n:155" class="idref" href="#n:155"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="d:156" class="idref" href="#d:156"><span class="id" title="binder">d</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="keyword">∀</span> (<a id="b:157" class="idref" href="#b:157"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb_invariant"><span class="id" title="definition">treeify_rb_invariant</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.ifpred"><span class="id" title="abbreviation">ifpred</span></a> <a class="idref" href="MMaps.RBTproofs.html#b:157"><span class="id" title="variable">b</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.BinPos.html#Pos.to_nat"><span class="id" title="definition">Pos.to_nat</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:155"><span class="id" title="variable">n</span></a>)) <a class="idref" href="MMaps.RBTproofs.html#d:156"><span class="id" title="variable">d</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_aux"><span class="id" title="definition">treeify_aux</span></a> <a class="idref" href="MMaps.RBTproofs.html#b:157"><span class="id" title="variable">b</span></a> <a class="idref" href="MMaps.RBTproofs.html#n:155"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> (<span class="id" title="var">d</span>,<span class="id" title="var">IHn</span>)|<span class="id" title="var">n</span> (<span class="id" title="var">d</span>,<span class="id" title="var">IHn</span>)| ].<br/>
&nbsp;- <span class="id" title="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">d</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_cont_rb"><span class="id" title="lemma">treeify_cont_rb</span></a>; [ <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHn</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) | <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">b</span>) | ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.Pnat.html#Pos2Nat.inj_xI"><span class="id" title="lemma">Pos2Nat.inj_xI</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> := <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.Pnat.html#Pos2Nat.is_pos"><span class="id" title="lemma">Pos2Nat.is_pos</span></a> <span class="id" title="var">n</span>). <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.neq_0_lt_0"><span class="id" title="lemma">Nat.neq_0_lt_0</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_pred"><span class="id" title="lemma">Nat.succ_pred</span></a>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;- <span class="id" title="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">d</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_cont_rb"><span class="id" title="lemma">treeify_cont_rb</span></a>; [ <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">b</span>) | <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHn</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>) | ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.Pnat.html#Pos2Nat.inj_xO"><span class="id" title="lemma">Pos2Nat.inj_xO</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> := <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.Pnat.html#Pos2Nat.is_pos"><span class="id" title="lemma">Pos2Nat.is_pos</span></a> <span class="id" title="var">n</span>). <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.neq_0_lt_0"><span class="id" title="lemma">Nat.neq_0_lt_0</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.succ_pred"><span class="id" title="lemma">Nat.succ_pred</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat.add_pred_l"><span class="id" title="lemma">Nat.add_pred_l</span></a>.<br/>
&nbsp;- <span class="id" title="tactic">∃</span> 0; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_zero_rb"><span class="id" title="lemma">treeify_zero_rb</span></a> | <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_one_rb"><span class="id" title="lemma">treeify_one_rb</span></a> ].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The black depth of <span class="inlinecode"><a class="idref" href="MMaps.RBT.html#MakeRaw.treeify"><span class="id" title="definition">treeify</span></a></span> <span class="inlinecode"><span class="id" title="var">l</span></span> is actually a log2, but
    we don't need to mention that. 
</div>
<div class="code">

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.treeify_rb" class="idref" href="#BalanceProps.treeify_rb"><span class="id" title="instance">treeify_rb</span></a> (<a id="l:158" class="idref" href="#l:158"><span class="id" title="binder">l</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.klist"><span class="id" title="definition">klist</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a>) : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify"><span class="id" title="definition">treeify</span></a> <a class="idref" href="MMaps.RBTproofs.html#l:158"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify"><span class="id" title="definition">treeify</span></a>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_aux_rb"><span class="id" title="lemma">treeify_aux_rb</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.plength"><span class="id" title="definition">plength</span></a> <span class="id" title="var">l</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">d</span>,<span class="id" title="var">H</span>).<br/>
&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.plength_spec"><span class="id" title="lemma">plength_spec</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.filter_rb" class="idref" href="#BalanceProps.filter_rb"><span class="id" title="instance">filter_rb</span></a> (<a id="f:159" class="idref" href="#f:159"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.key"><span class="id" title="definition">key</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="m:160" class="idref" href="#m:160"><span class="id" title="binder">m</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:160"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:159"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:160"><span class="id" title="variable">m</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.filter"><span class="id" title="definition">filter</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb"><span class="id" title="instance">treeify_rb</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.partition_rb1" class="idref" href="#BalanceProps.partition_rb1"><span class="id" title="instance">partition_rb1</span></a> (<a id="f:161" class="idref" href="#f:161"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.key"><span class="id" title="definition">key</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="m:162" class="idref" href="#m:162"><span class="id" title="binder">m</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:162"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.partition"><span class="id" title="definition">partition</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:161"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:162"><span class="id" title="variable">m</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.partition"><span class="id" title="definition">partition</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.partition_aux"><span class="id" title="definition">partition_aux</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb"><span class="id" title="instance">treeify_rb</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.partition_rb2" class="idref" href="#BalanceProps.partition_rb2"><span class="id" title="instance">partition_rb2</span></a> (<a id="f:163" class="idref" href="#f:163"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.key"><span class="id" title="definition">key</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt.elt"><span class="id" title="variable">elt</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="m:164" class="idref" href="#m:164"><span class="id" title="binder">m</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:164"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.partition"><span class="id" title="definition">partition</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:163"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:164"><span class="id" title="variable">m</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.partition"><span class="id" title="definition">partition</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.partition_aux"><span class="id" title="definition">partition_aux</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb"><span class="id" title="instance">treeify_rb</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Elt"><span class="id" title="section">Elt</span></a>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.map_rb" class="idref" href="#BalanceProps.map_rb"><span class="id" title="instance">map_rb</span></a> {<a id="elt:165" class="idref" href="#elt:165"><span class="id" title="binder">elt</span></a> <a id="elt':166" class="idref" href="#elt':166"><span class="id" title="binder">elt'</span></a>}(<a id="f:167" class="idref" href="#f:167"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#elt:165"><span class="id" title="variable">elt</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MMaps.RBTproofs.html#elt':166"><span class="id" title="variable">elt'</span></a>) <a id="m:168" class="idref" href="#m:168"><span class="id" title="binder">m</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:168"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.map"><span class="id" title="definition">map</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:167"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:168"><span class="id" title="variable">m</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">n</span>,<span class="id" title="var">H</span>). <span class="id" title="tactic">∃</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.mapi_rb" class="idref" href="#BalanceProps.mapi_rb"><span class="id" title="instance">mapi_rb</span></a> {<a id="elt:169" class="idref" href="#elt:169"><span class="id" title="binder">elt</span></a> <a id="elt':170" class="idref" href="#elt':170"><span class="id" title="binder">elt'</span></a>}(<a id="f:171" class="idref" href="#f:171"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.key"><span class="id" title="definition">key</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MMaps.RBTproofs.html#elt:169"><span class="id" title="variable">elt</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MMaps.RBTproofs.html#elt':170"><span class="id" title="variable">elt'</span></a>) <a id="m:172" class="idref" href="#m:172"><span class="id" title="binder">m</span></a> : <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:172"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.mapi"><span class="id" title="definition">mapi</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:171"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:172"><span class="id" title="variable">m</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> (<span class="id" title="var">n</span>,<span class="id" title="var">H</span>). <span class="id" title="tactic">∃</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="BalanceProps.merge_rb" class="idref" href="#BalanceProps.merge_rb"><span class="id" title="instance">merge_rb</span></a> {<a id="elt:173" class="idref" href="#elt:173"><span class="id" title="binder">elt</span></a> <a id="elt':174" class="idref" href="#elt':174"><span class="id" title="binder">elt'</span></a> <a id="elt'':175" class="idref" href="#elt'':175"><span class="id" title="binder">elt''</span></a>}<br/>
&nbsp;(<a id="f:176" class="idref" href="#f:176"><span class="id" title="binder">f</span></a>:<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MMaps.RBTproofs.html#elt:173"><span class="id" title="variable">elt</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MMaps.RBTproofs.html#elt':174"><span class="id" title="variable">elt'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MMaps.RBTproofs.html#elt'':175"><span class="id" title="variable">elt''</span></a>) <a id="m:177" class="idref" href="#m:177"><span class="id" title="binder">m</span></a> <a id="m':178" class="idref" href="#m':178"><span class="id" title="binder">m'</span></a> :<br/>
&nbsp;<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:177"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> <a class="idref" href="MMaps.RBTproofs.html#m':178"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="class">Rbt</span></a> (<a class="idref" href="MMaps.RBTproofs.html#BalanceProps.merge"><span class="id" title="definition">merge</span></a> <a class="idref" href="MMaps.RBTproofs.html#f:176"><span class="id" title="variable">f</span></a> <a class="idref" href="MMaps.RBTproofs.html#m:177"><span class="id" title="variable">m</span></a> <a class="idref" href="MMaps.RBTproofs.html#m':178"><span class="id" title="variable">m'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.merge"><span class="id" title="definition">merge</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps.treeify_rb"><span class="id" title="instance">treeify_rb</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MMaps.RBTproofs.html#BalanceProps"><span class="id" title="module">BalanceProps</span></a>.<br/>

<br/>
</div>

<div class="doc">
We could hence define <span class="inlinecode"><a class="idref" href="MMaps.GenTree.html#Props.Ok"><span class="id" title="record">Ok</span></a></span> <span class="inlinecode"><a class="idref" href="MMaps.Raw.html#WS.Specs.m"><span class="id" title="variable">m</span></a></span> as <span class="inlinecode"><a class="idref" href="MMaps.GenTree.html#Props.Bst"><span class="id" title="inductive">Bst</span></a></span> <span class="inlinecode"><a class="idref" href="MMaps.Raw.html#WS.Specs.m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode">∧</span> <span class="inlinecode"><a class="idref" href="MMaps.RBTproofs.html#BalanceProps.Rbt"><span class="id" title="record">Rbt</span></a></span> <span class="inlinecode"><a class="idref" href="MMaps.Raw.html#WS.Specs.m"><span class="id" title="variable">m</span></a></span> and re-validate
    the <span class="inlinecode"><span class="id" title="var">Raw.S</span></span> signature. This would be more robust in case new ops
    are added in the signature. But that would be yet another wrapper,
    so we don't do it for the moment. 
</div>
<div class="code">
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr">coqdoc</a> and improved with <a href="https://github.com/palmskog/coqdocjs">CoqdocJS</a> as adapted for <a href="https://github.com/coq-community">coq-community</a>
</div>
</div>
</body>

</html>
